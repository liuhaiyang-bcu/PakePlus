<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>æ¸…é™¤æ‰€æœ‰å†…å®¹ - æœ‰æ•°è§„åˆ’</title>
    <link rel="icon" href="img/logo.png" type="image/png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/clear-dialog.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* è®¾ç½®é¡µé¢ä¸“ç”¨å˜é‡ */
            --settings-primary: #667eea;
            --settings-primary-hover: #5a6fd8;
            --settings-danger: #e53e3e;
            --settings-danger-hover: #c53030;
            --settings-success: #38a169;
            --settings-warning: #dd6b20;
            
            /* æµ…è‰²ä¸»é¢˜ */
            --settings-bg-light: #f5f7fa;
            --settings-card-bg-light: #ffffff;
            --settings-text-primary-light: #2d3748;
            --settings-text-secondary-light: #4a5568;
            --settings-border-light: #e1e5eb;
            --settings-hover-light: #f8f9fa;
            --settings-shadow-light: rgba(0, 0, 0, 0.05);
            
            /* æ·±è‰²ä¸»é¢˜ */
            --settings-bg-dark: #0f172a;
            --settings-card-bg-dark: #1e293b;
            --settings-text-primary-dark: #f1f5f9;
            --settings-text-secondary-dark: #cbd5e1;
            --settings-border-dark: #334155;
            --settings-hover-dark: #334155;
            --settings-shadow-dark: rgba(0, 0, 0, 0.3);
        }
        
        body {
            background-color: var(--settings-bg-light);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            -webkit-overflow-scrolling: touch;
            overflow-y: auto;
            height: 100%;
            overscroll-behavior: auto;
            color: var(--settings-text-primary-light);
            transition: background-color 0.3s, color 0.3s;
            padding-top: 60px;
            position: relative;
            margin: 0;
        }
        
        body.dark-theme {
            background-color: var(--settings-bg-dark);
            color: var(--settings-text-primary-dark);
        }
        
        .clear-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: calc(100vh - 60px);
        }
        
        /* é¡¶éƒ¨å›ºå®šå¯¼èˆªæ  */
        .clear-header {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px 15px;
            border-bottom: 1px solid var(--settings-border-light);
            background-color: var(--settings-bg-light);
            position: fixed !important;
            top: 0 !important;
            left: 0;
            right: 0;
            z-index: 9999 !important;
            height: 60px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }
        
        body.dark-theme .clear-header {
            border-bottom: 1px solid var(--settings-border-dark);
            background-color: var(--settings-bg-dark);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .clear-header .back-btn {
            position: absolute;
            left: 15px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--settings-primary);
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }
        
        .clear-header .back-btn:hover {
            background-color: var(--settings-hover-light);
            color: var(--settings-primary-hover);
        }
        
        body.dark-theme .clear-header .back-btn:hover {
            background-color: var(--settings-hover-dark);
            color: #88aaff;
        }
        
        .clear-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--settings-text-primary-light);
            margin: 0;
            transition: color 0.3s;
            text-align: center;
        }
        
        body.dark-theme .clear-title {
            color: var(--settings-text-primary-dark);
        }
        
        .clear-content {
            background: var(--settings-card-bg-light);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 12px var(--settings-shadow-light);
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        body.dark-theme .clear-content {
            background: var(--settings-card-bg-dark);
            box-shadow: 0 4px 12px var(--settings-shadow-dark);
        }
        
        .clear-icon {
            font-size: 4em;
            margin-bottom: 20px;
            color: #ff4757;
            text-align: center;
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .clear-title-main {
            font-size: 24px;
            font-weight: 600;
            color: var(--settings-text-primary-light);
            margin-bottom: 20px;
            text-align: center;
            transition: color 0.3s;
        }
        
        body.dark-theme .clear-title-main {
            color: var(--settings-text-primary-dark);
        }
        
        .clear-description {
            color: var(--settings-text-secondary-light);
            line-height: 1.6;
            margin-bottom: 25px;
            font-size: 16px;
            text-align: center;
            transition: color 0.3s;
        }
        
        body.dark-theme .clear-description {
            color: var(--settings-text-secondary-dark);
        }
        
        .clear-warning {
            background: rgba(255, 71, 87, 0.1);
            border: 1px solid rgba(255, 71, 87, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            color: #ff4757;
            font-weight: 500;
            text-align: center;
        }
        
        .clear-warning .warning-text {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 16px;
        }
        
        .clear-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .clear-btn {
            padding: 12px 30px;
            border-radius: 25px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 120px;
            position: relative;
            overflow: hidden;
        }
        
        .clear-btn.cancel {
            background: var(--settings-hover-light);
            color: var(--settings-text-secondary-light);
            border: 2px solid var(--settings-border-light);
        }
        
        body.dark-theme .clear-btn.cancel {
            background: var(--settings-hover-dark);
            color: var(--settings-text-secondary-dark);
            border: 2px solid var(--settings-border-dark);
        }
        
        .clear-btn.cancel:hover {
            background: var(--settings-card-bg-light);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        body.dark-theme .clear-btn.cancel:hover {
            background: var(--settings-card-bg-dark);
        }
        
        .clear-btn.confirm {
            background: linear-gradient(135deg, #ff4757, #ff3742);
            color: white;
            border: 2px solid #ff4757;
        }
        
        .clear-btn.confirm:hover {
            background: linear-gradient(135deg, #ff3742, #ff2e3a);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 71, 87, 0.3);
        }
        
        .clear-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* ç¡®è®¤æ­¥éª¤æ ·å¼ */
        .clear-confirm-step {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .clear-confirm-step.show {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .clear-confirm-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--settings-border-light);
            border-radius: 10px;
            font-size: 16px;
            margin: 20px 0;
            background: var(--settings-card-bg-light);
            color: var(--settings-text-primary-light);
            transition: all 0.3s;
            box-sizing: border-box;
        }
        
        body.dark-theme .clear-confirm-input {
            border: 2px solid var(--settings-border-dark);
            background: var(--settings-card-bg-dark);
            color: var(--settings-text-primary-dark);
        }
        
        .clear-confirm-input:focus {
            outline: none;
            border-color: #ff4757;
            box-shadow: 0 0 0 3px rgba(255, 71, 87, 0.1);
        }
        
        .clear-confirm-input.error {
            border-color: #ff4757;
            animation: shake 0.5s ease-in-out;
        }
        
        .clear-confirm-hint {
            font-size: 14px;
            color: var(--settings-text-secondary-light);
            margin-bottom: 20px;
            font-style: italic;
            text-align: center;
            transition: color 0.3s;
        }
        
        body.dark-theme .clear-confirm-hint {
            color: var(--settings-text-secondary-dark);
        }
        
        /* å¹³æ¿è®¾å¤‡ */
        @media (max-width: 768px) {
            .clear-header {
                padding: 10px 15px;
                height: 50px;
            }
            
            .clear-header .back-btn {
                font-size: 18px;
                width: 36px;
                height: 36px;
            }
            
            .clear-title {
                font-size: 18px;
            }
            
            .clear-content {
                padding: 20px;
            }
            
            .clear-title-main {
                font-size: 22px;
            }
            
            .clear-description {
                font-size: 15px;
            }
            
            .clear-warning .warning-text {
                font-size: 15px;
            }
            
            .clear-btn {
                padding: 14px 25px;
                font-size: 15px;
                min-width: 100px;
            }
        }
        
        /* æ‰‹æœºè®¾å¤‡ */
        @media (max-width: 480px) {
            .clear-container {
                padding: 15px 10px;
            }
            
            .clear-header {
                padding: 8px 15px;
                height: 45px;
            }
            
            .clear-header .back-btn {
                font-size: 16px;
                width: 32px;
                height: 32px;
            }
            
            .clear-title {
                font-size: 16px;
            }
            
            .clear-content {
                padding: 15px;
            }
            
            .clear-icon {
                font-size: 3em;
                margin-bottom: 15px;
            }
            
            .clear-title-main {
                font-size: 20px;
                margin-bottom: 15px;
            }
            
            .clear-description {
                font-size: 14px;
                margin-bottom: 20px;
            }
            
            .clear-warning {
                padding: 15px;
                margin-bottom: 25px;
            }
            
            .clear-warning .warning-text {
                font-size: 14px;
                gap: 8px;
            }
            
            .clear-actions {
                flex-direction: column;
                gap: 12px;
            }
            
            .clear-btn {
                width: 100%;
                padding: 14px 20px;
                font-size: 16px;
            }
            
            .clear-confirm-input {
                padding: 14px 15px;
                font-size: 16px;
            }
            
            .clear-confirm-hint {
                font-size: 13px;
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body class="light-theme">
    <!-- å›ºå®šé¡¶éƒ¨è¿”å›æŒ‰é’®å’Œæ ‡é¢˜ -->
    <div class="clear-header">
        <button class="back-btn" onclick="window.location.href='settings.html'">
            <i class="fas fa-arrow-left"></i>
        </button>
        <h1 class="clear-title">æ¸…é™¤æ‰€æœ‰å†…å®¹</h1>
    </div>
    
    <div class="clear-container">
        <div class="clear-content">
            <div class="clear-icon">ğŸ—‘ï¸</div>
            <h2 class="clear-title-main">ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰å†…å®¹å—ï¼Ÿ</h2>
            <p class="clear-description">
                æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤æ‚¨çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ï¼š<br>
                â€¢ æ‰€æœ‰äº‹ä»¶å’Œä»»åŠ¡<br>
                â€¢ é¡¹ç›®ä¿¡æ¯<br>
                â€¢ æ¸…å•å’Œå€’æ•°æ—¥<br>
                â€¢ ä¸“æ³¨è®°å½•å’Œç§¯åˆ†<br>
                â€¢ ç”¨æˆ·è®¾ç½®å’Œåå¥½
            </p>
            
            <div class="clear-warning">
                <div class="warning-text">
                    <i class="fas fa-exclamation-circle"></i>
                    <span>æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œï¼</span>
                </div>
            </div>
            
            <!-- ç¬¬ä¸€æ­¥ç¡®è®¤ -->
            <div class="clear-confirm-step" id="clear-step-1">
                <div class="clear-actions">
                    <button class="clear-btn cancel" id="clear-cancel-btn">
                        <i class="fas fa-times"></i>
                        å–æ¶ˆ
                    </button>
                    <button class="clear-btn confirm" id="clear-confirm-btn">
                        <i class="fas fa-trash"></i>
                        ç¡®è®¤æ¸…é™¤
                    </button>
                </div>
            </div>
            
            <!-- ç¬¬äºŒæ­¥ç¡®è®¤ -->
            <div class="clear-confirm-step" id="clear-step-2">
                <div class="clear-confirm-hint">
                    è¯·è¾“å…¥ <strong>"æ¸…é™¤æ‰€æœ‰å†…å®¹"</strong> ä»¥ç¡®è®¤æ“ä½œ
                </div>
                <input type="text" class="clear-confirm-input" id="clear-confirm-input" 
                       placeholder="è¯·è¾“å…¥ï¼šæ¸…é™¤æ‰€æœ‰å†…å®¹">
                <div class="clear-actions">
                    <button class="clear-btn cancel" id="clear-back-btn">
                        <i class="fas fa-arrow-left"></i>
                        è¿”å›
                    </button>
                    <button class="clear-btn confirm" id="clear-final-btn" disabled>
                        <i class="fas fa-trash"></i>
                        æœ€ç»ˆç¡®è®¤
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="js/storage.js"></script>
    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–ä¸»é¢˜
            initTheme();
            
            // ç»‘å®šäº‹ä»¶
            bindEvents();
            
            // æ˜¾ç¤ºç¬¬ä¸€æ­¥
            showStep1();
        });
        
        // åˆå§‹åŒ–ä¸»é¢˜
        function initTheme() {
            try {
                // è·å–å­˜å‚¨çš„è®¾ç½®æ•°æ®
                const userData = StorageManager.getData();
                const settings = userData && userData.settings ? userData.settings : null;
                
                // å¦‚æœæ²¡æœ‰è·å–åˆ°è®¾ç½®æ•°æ®ï¼Œä½¿ç”¨é»˜è®¤å€¼
                const theme = settings && settings.theme ? settings.theme : 'system';
                
                // ç§»é™¤æ‰€æœ‰ä¸»é¢˜ç±»
                document.body.classList.remove('light-theme', 'dark-theme', 'dark-mode');
                
                // æ ¹æ®è®¾ç½®åº”ç”¨ä¸»é¢˜
                if (theme === 'dark') {
                    document.body.classList.add('dark-theme');
                } else if (theme === 'light') {
                    document.body.classList.add('light-theme');
                } else if (theme === 'auto' || theme === 'system') {
                    // è‡ªåŠ¨æ¨¡å¼ï¼šæ ¹æ®æ—¶é—´åˆ¤æ–­
                    const currentHour = new Date().getHours();
                    const isDarkMode = currentHour >= 18 || currentHour < 6;
                    
                    if (isDarkMode) {
                        document.body.classList.add('dark-theme');
                    } else {
                        document.body.classList.add('light-theme');
                    }
                }
                
                // ç›‘å¬å­˜å‚¨å˜åŒ–ï¼Œå®ç°ä¸»é¢˜è”åŠ¨
                window.addEventListener('storage', function(e) {
                    if (e.key === 'schedule_app_all_users') {
                        try {
                            // é‡æ–°åŠ è½½ä¸»é¢˜è®¾ç½®
                            const allUsersData = JSON.parse(e.newValue);
                            const userId = localStorage.getItem('schedule_app_user_id');
                            if (userId && allUsersData[userId]) {
                                const userData = allUsersData[userId];
                                const newTheme = userData.settings && userData.settings.theme ? 
                                                userData.settings.theme : 'system';
                                
                                // ç§»é™¤æ‰€æœ‰ä¸»é¢˜ç±»
                                document.body.classList.remove('light-theme', 'dark-theme');
                                
                                // åº”ç”¨æ–°ä¸»é¢˜
                                if (newTheme === 'dark') {
                                    document.body.classList.add('dark-theme');
                                } else if (newTheme === 'light') {
                                    document.body.classList.add('light-theme');
                                } else if (newTheme === 'auto' || newTheme === 'system') {
                                    const currentHour = new Date().getHours();
                                    const isDarkMode = currentHour >= 18 || currentHour < 6;
                                    
                                    if (isDarkMode) {
                                        document.body.classList.add('dark-theme');
                                    } else {
                                        document.body.classList.add('light-theme');
                                    }
                                }
                            }
                        } catch (error) {
                            console.error('è§£æå­˜å‚¨æ•°æ®å¤±è´¥:', error);
                        }
                    }
                });
            } catch (error) {
                console.error('åˆå§‹åŒ–ä¸»é¢˜å¤±è´¥:', error);
                // é»˜è®¤ä½¿ç”¨æµ…è‰²ä¸»é¢˜
                document.body.classList.add('light-theme');
            }
        }
        
        // ç»‘å®šäº‹ä»¶
        function bindEvents() {
            // å–æ¶ˆæŒ‰é’®
            const cancelBtn = document.getElementById('clear-cancel-btn');
            if (cancelBtn) {
                cancelBtn.addEventListener('click', function() {
                    window.location.href = 'settings.html';
                });
            }
            
            // ç¡®è®¤æ¸…é™¤æŒ‰é’®
            const confirmBtn = document.getElementById('clear-confirm-btn');
            if (confirmBtn) {
                confirmBtn.addEventListener('click', function() {
                    showStep2();
                });
            }
            
            // è¿”å›æŒ‰é’®
            const backBtn = document.getElementById('clear-back-btn');
            if (backBtn) {
                backBtn.addEventListener('click', function() {
                    showStep1();
                });
            }
            
            // æœ€ç»ˆç¡®è®¤æŒ‰é’®
            const finalBtn = document.getElementById('clear-final-btn');
            if (finalBtn) {
                finalBtn.addEventListener('click', function() {
                    executeClear();
                });
            }
            
            // ç¡®è®¤è¾“å…¥æ¡†
            const confirmInput = document.getElementById('clear-confirm-input');
            if (confirmInput) {
                confirmInput.addEventListener('input', function(e) {
                    validateInput(e.target.value);
                });
                
                confirmInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !finalBtn.disabled) {
                        e.preventDefault();
                        executeClear();
                    }
                });
            }
        }
        
        // æ˜¾ç¤ºç¬¬ä¸€æ­¥
        function showStep1() {
            const step1 = document.getElementById('clear-step-1');
            const step2 = document.getElementById('clear-step-2');
            
            if (step1 && step2) {
                step1.classList.add('show');
                step2.classList.remove('show');
            }
        }
        
        // æ˜¾ç¤ºç¬¬äºŒæ­¥
        function showStep2() {
            const step1 = document.getElementById('clear-step-1');
            const step2 = document.getElementById('clear-step-2');
            
            if (step1 && step2) {
                step1.classList.remove('show');
                step2.classList.add('show');
                
                // èšç„¦åˆ°è¾“å…¥æ¡†
                const confirmInput = document.getElementById('clear-confirm-input');
                if (confirmInput) {
                    setTimeout(() => {
                        confirmInput.focus();
                    }, 300);
                }
            }
        }
        
        // éªŒè¯è¾“å…¥
        function validateInput(value) {
            const expectedText = 'æ¸…é™¤æ‰€æœ‰å†…å®¹';
            const isValid = value.trim() === expectedText;
            
            const finalBtn = document.getElementById('clear-final-btn');
            const confirmInput = document.getElementById('clear-confirm-input');
            
            if (finalBtn) {
                finalBtn.disabled = !isValid;
            }
            
            if (confirmInput) {
                if (isValid) {
                    confirmInput.classList.remove('error');
                } else {
                    confirmInput.classList.add('error');
                }
            }
        }
        
        // æ‰§è¡Œæ¸…é™¤æ“ä½œ
        async function executeClear() {
            try {
                // ç¦ç”¨æŒ‰é’®ï¼Œæ˜¾ç¤ºåŠ è½½çŠ¶æ€
                const finalBtn = document.getElementById('clear-final-btn');
                if (finalBtn) {
                    finalBtn.disabled = true;
                    finalBtn.innerHTML = '<span class="clear-loading"></span>æ­£åœ¨æ¸…é™¤...';
                }
                
                // è®¾ç½®ç¡®è®¤æ ‡è®°
                sessionStorage.setItem('clearDataConfirmed', 'true');
                
                // å»¶è¿Ÿä¸€ä¸‹è®©ç”¨æˆ·çœ‹åˆ°åŠ è½½çŠ¶æ€
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // è·³è½¬åˆ°æ¸…é™¤é¡µé¢
                window.location.href = 'clear.html';
                
            } catch (error) {
                console.error('æ¸…é™¤æ•°æ®å¤±è´¥:', error);
                
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                const finalBtn = document.getElementById('clear-final-btn');
                if (finalBtn) {
                    finalBtn.disabled = false;
                    finalBtn.innerHTML = '<i class="fas fa-trash"></i>æœ€ç»ˆç¡®è®¤';
                }
                
                // æ˜¾ç¤ºé”™è¯¯æç¤º
                if (window.UIManager && typeof UIManager.showNotification === 'function') {
                    UIManager.showNotification('æ¸…é™¤æ•°æ®å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                }
            }
        }
        
        // é˜²æ­¢é¡µé¢å†…å®¹è¢«éšæ„å¤åˆ¶
        (function preventCopy() {
            function initPreventCopy() {
                // ç¦ç”¨æ–‡æœ¬é€‰æ‹©
                document.body.style.userSelect = 'none';
                document.body.style.webkitUserSelect = 'none';
                document.body.style.mozUserSelect = 'none';
                document.body.style.msUserSelect = 'none';
                
                // ç¦ç”¨è§¦æ‘¸é€‰æ‹©
                document.body.style.webkitTouchCallout = 'none';
                
                // å…è®¸è¾“å…¥æ¡†å’Œæ–‡æœ¬åŸŸæ­£å¸¸é€‰æ‹©å’Œå¤åˆ¶
                const allowSelect = function(e) {
                    const target = e.target;
                    const tagName = target.tagName.toLowerCase();
                    const isInput = tagName === 'input' || tagName === 'textarea';
                    const isEditable = target.isContentEditable || target.contentEditable === 'true';
                    return isInput || isEditable;
                };
                
                // é˜»æ­¢å³é”®èœå•ï¼ˆè¾“å…¥æ¡†é™¤å¤–ï¼‰
                document.addEventListener('contextmenu', function(e) {
                    if (!allowSelect(e)) {
                        e.preventDefault();
                        return false;
                    }
                }, { passive: false });
                
                // é˜»æ­¢å¤åˆ¶æ“ä½œï¼ˆè¾“å…¥æ¡†é™¤å¤–ï¼‰
                document.addEventListener('copy', function(e) {
                    if (!allowSelect(e)) {
                        e.preventDefault();
                        return false;
                    }
                }, { passive: false });
                
                // é˜»æ­¢å‰ªåˆ‡æ“ä½œï¼ˆè¾“å…¥æ¡†é™¤å¤–ï¼‰
                document.addEventListener('cut', function(e) {
                    if (!allowSelect(e)) {
                        e.preventDefault();
                        return false;
                    }
                }, { passive: false });
                
                // é˜»æ­¢æ‹–æ‹½é€‰æ‹©ï¼ˆè¾“å…¥æ¡†é™¤å¤–ï¼‰
                document.addEventListener('selectstart', function(e) {
                    if (!allowSelect(e)) {
                        e.preventDefault();
                        return false;
                    }
                }, { passive: false });
                
                // é˜»æ­¢é”®ç›˜å¿«æ·é”®å¤åˆ¶ï¼ˆè¾“å…¥æ¡†é™¤å¤–ï¼‰
                document.addEventListener('keydown', function(e) {
                    if (!allowSelect(e)) {
                        // é˜»æ­¢ Ctrl+C, Ctrl+X, Ctrl+A
                        if ((e.ctrlKey || e.metaKey) && (e.key === 'c' || e.key === 'x' || e.key === 'a')) {
                            e.preventDefault();
                            return false;
                        }
                    }
                }, { passive: false });
                
                // ä¸ºè¾“å…¥æ¡†å’Œæ–‡æœ¬åŸŸå¯ç”¨æ–‡æœ¬é€‰æ‹©
                const inputs = document.querySelectorAll('input, textarea');
                inputs.forEach(input => {
                    input.style.userSelect = 'text';
                    input.style.webkitUserSelect = 'text';
                    input.style.mozUserSelect = 'text';
                    input.style.msUserSelect = 'text';
                });
            }
            
            // å¦‚æœDOMå·²åŠ è½½ï¼Œç›´æ¥æ‰§è¡Œï¼›å¦åˆ™ç­‰å¾…DOMåŠ è½½
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initPreventCopy);
            } else {
                initPreventCopy();
            }
        })();
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­£åœ¨æ¸…é™¤è½¯ä»¶æ‰€æœ‰å†…å®¹ - æœ‰æ•°è§„åˆ’</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/theme.css">
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            background: var(--bg-color);
            color: var(--text-color);
        }

        .clear-container {
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        .progress-container {
            width: 100%;
            background-color: var(--border-color);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            width: 0%;
            height: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .clear-message {
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .clear-icon {
            font-size: 3em;
            margin-bottom: 20px;
            color: #667eea;
        }

        /* é˜²æ­¢æ–‡æœ¬é€‰æ‹©å’Œå¤åˆ¶ */
        body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
        }

        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body class="dark-theme">
    <div class="clear-container">
        <div class="clear-icon">
            <i class="fas fa-broom"></i>
        </div>
        <div class="clear-message">æ­£åœ¨æ¸…é™¤æ•°æ®...</div>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // é˜²æ­¢é¡µé¢å†…å®¹è¢«éšæ„å¤åˆ¶
            // ç¦ç”¨æ–‡æœ¬é€‰æ‹©
            document.body.style.userSelect = 'none';
            document.body.style.webkitUserSelect = 'none';
            document.body.style.mozUserSelect = 'none';
            document.body.style.msUserSelect = 'none';
            
            // ç¦ç”¨è§¦æ‘¸é€‰æ‹©
            document.body.style.webkitTouchCallout = 'none';
            
            // é˜»æ­¢å³é”®èœå•
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                return false;
            });
            
            // é˜»æ­¢å¤åˆ¶æ“ä½œ
            document.addEventListener('copy', function(e) {
                e.preventDefault();
                return false;
            });
            
            // é˜»æ­¢å‰ªåˆ‡æ“ä½œ
            document.addEventListener('cut', function(e) {
                e.preventDefault();
                return false;
            });
            
            // é˜»æ­¢æ‹–æ‹½é€‰æ‹©
            document.addEventListener('selectstart', function(e) {
                e.preventDefault();
                return false;
            });
            
            // é˜»æ­¢é”®ç›˜å¿«æ·é”®å¤åˆ¶
            document.addEventListener('keydown', function(e) {
                // é˜»æ­¢ Ctrl+C, Ctrl+X, Ctrl+A
                if ((e.ctrlKey || e.metaKey) && (e.key === 'c' || e.key === 'x' || e.key === 'a')) {
                    e.preventDefault();
                    return false;
                }
            });

            const progressBar = document.getElementById('progressBar');
            let progress = 0;
            
            // æ¸…é™¤æœ¬åœ°å­˜å‚¨æ•°æ®
            function clearData() {
                // æ¸…é™¤æ‰€æœ‰localStorageæ•°æ®
                localStorage.clear();
                // æ¸…é™¤æ‰€æœ‰sessionStorageæ•°æ®
                sessionStorage.clear();
                
                // æ˜¾å¼æ¸…é™¤å¿ƒæƒ…å°è®°æ•°æ®
                try {
                    localStorage.removeItem('moodEntries');
                } catch (e) {}

                // ç‰¹åˆ«æ¸…é™¤ç•ªèŒ„æ—¶é’Ÿç›¸å…³æ•°æ®ï¼ˆç¡®ä¿å®Œå…¨æ¸…é™¤ï¼‰
                localStorage.removeItem('pomodoroAppData');
                localStorage.removeItem('focusStats');
                localStorage.removeItem('lastDailyReset');
                localStorage.removeItem('lastSelectedTask');
                localStorage.removeItem('toolsLastUseTime');
                localStorage.removeItem('recentItems');
                localStorage.removeItem('favorites');
                sessionStorage.removeItem('focusTasks');
                sessionStorage.removeItem('clearDataConfirmed');
                
                // æ¸…é™¤StorageManagerä¸­çš„focusStateæ•°æ®
                try {
                    const data = {
                        user: {
                            nickname: '',
                            avatar: 'assets/avatar-default.png'
                        },
                        settings: {
                            theme: 'system',
                            notifications: true,
                            sounds: true,
                            autoStartBreak: true,
                            strictMode: false
                        },
                        events: [],
                        projects: [],
                        focusTime: {
                            total: 0,
                            today: 0,
                            history: []
                        },
                        // ç¡®ä¿æ¸…é™¤ç•ªèŒ„æ—¶é’Ÿç›¸å…³æ•°æ®
                        focusState: null,
                        focusLogs: [],
                        taskFocusStats: {},
                        lastSelectedTask: null,
                        todayFocusTime: 0,
                        totalFocusTime: 0,
                        medals: [
                            { id: 'newcomer', name: 'åˆæ¥ä¹åˆ°', icon: 'ğŸ¯', description: 'æ¬¢è¿ä½¿ç”¨æœ‰æ•°è§„åˆ’ï¼', unlocked: true },
                            { id: 'points-100', name: 'ç§¯åˆ†è¾¾äºº', icon: 'ğŸŒŸ', description: 'ç´¯è®¡è·å¾—100ç§¯åˆ†', unlocked: false },
                            { id: 'points-500', name: 'ç§¯åˆ†å¤§å¸ˆ', icon: 'ğŸ’«', description: 'ç´¯è®¡è·å¾—500ç§¯åˆ†', unlocked: false },
                            { id: 'points-1000', name: 'ç§¯åˆ†ç‹è€…', icon: 'âœ¨', description: 'ç´¯è®¡è·å¾—1000ç§¯åˆ†', unlocked: false },
                            { id: 'time-1h', name: 'æ—¶é—´æ¢ç´¢è€…', icon: 'â±ï¸', description: 'ç´¯è®¡ä½¿ç”¨1å°æ—¶', unlocked: false },
                            { id: 'time-5h', name: 'æ—¶é—´ç®¡ç†è€…', icon: 'âŒ›', description: 'ç´¯è®¡ä½¿ç”¨5å°æ—¶', unlocked: false },
                            { id: 'time-24h', name: 'æ—¶é—´å¤§å¸ˆ', icon: 'â³', description: 'ç´¯è®¡ä½¿ç”¨24å°æ—¶', unlocked: false },
                            { id: 'streak-3', name: 'åšæŒä¸æ‡ˆ', icon: 'ğŸ”¥', description: 'è¿ç»­ä½¿ç”¨3å¤©', unlocked: false },
                            { id: 'streak-7', name: 'æŒä¹‹ä»¥æ’', icon: 'ğŸ’ª', description: 'è¿ç»­ä½¿ç”¨7å¤©', unlocked: false },
                            { id: 'streak-30', name: 'ä¹ æƒ¯å…»æˆ', icon: 'ğŸ†', description: 'è¿ç»­ä½¿ç”¨30å¤©', unlocked: false }
                        ],
                        points: 0,
                        wheelItems: [
                            { text: 'å¬å¬æ­Œ', color: '#4285f4' },
                            { text: 'æ­‡ä¼šå„¿', color: '#34a853' },
                            { text: 'æ‰“å±€æ¸¸æˆ', color: '#fbbc05' },
                            { text: 'å‡ºå»èµ°èµ°', color: '#ea4335' },
                            { text: 'å†å¿™ä¼šå„¿', color: '#673ab7' },
                            { text: 'å–æ¯æ°´', color: '#3f51b5' }
                        ],
                        loginDates: [],
                        lastLogin: null,
                        repeatTypes: {
                            none: 'ä¸é‡å¤',
                            daily: 'æ¯å¤©',
                            weekly: 'æ¯å‘¨',
                            monthly: 'æ¯æœˆ',
                            yearly: 'æ¯å¹´'
                        }
                    };
                    
                    // ä¿å­˜é‡ç½®åçš„é»˜è®¤æ•°æ®
                    localStorage.setItem('schedule_app_data', JSON.stringify(data));
                    // é‡ç½®å¿ƒæƒ…å°è®°ä¸ºç©ºæ•°ç»„ï¼Œé¿å…é¦–æ¬¡è¿›å…¥å¼‚å¸¸
                    localStorage.setItem('moodEntries', JSON.stringify([]));
                } catch (error) {
                    console.error('é‡ç½®é»˜è®¤æ•°æ®å¤±è´¥:', error);
                }

                // æ¸…é™¤ç”¨æˆ·ç›¸å…³æ•°æ®
                localStorage.removeItem('userLocation');
                localStorage.removeItem('userAvatar');
                localStorage.removeItem('userNickname');
                localStorage.removeItem('tempUserNickname');
                localStorage.removeItem('tempUserAvatar');
            }

            // æ›´æ–°è¿›åº¦æ¡
            function updateProgress() {
                progress += 1;
                progressBar.style.width = progress + '%';
                
                if (progress < 100) {
                    setTimeout(updateProgress, 20); // 2ç§’å†…å®Œæˆ
                } else {
                    clearData();
                    setTimeout(() => {
                        // è®¾ç½®æ•°æ®æ¸…é™¤æ ‡è®°
                        sessionStorage.setItem('dataCleared', 'true');
                        // æ¸…é™¤åŠŸèƒ½ä»‹ç»é¡µé¢æ ‡è®°
                        localStorage.removeItem('hasSeenFeatureIntro');
                        window.location.href = 'index.html';
                    }, 500);
                }
            }

            // å¼€å§‹è¿›åº¦æ¡åŠ¨ç”»
            updateProgress();
        });
    </script>
</body>
</html> 